<?php
$form->prepare();
echo 
$this->FormDefault(['legend' => 'Buscar Seguros fechados(*Mensais) para Renovação com base na data fim da vigência:'],'inicio',$this, $form),
    "<td>",
        $this->FormDefault(['ajaxStatus','autoComp','subOpcao','administradora'],'hidden'),
        $this->FormDefault(['mesNiver' => 'select']),
    "</td>\r<td>",
        $this->FormDefault(['anoFiltro' => 'select']),
    "</td>\r",
"</tr><tr>\r",
    "<td colspan='2'>\r",
        $this->FormDefault(['name' => 'administradoraDesc','icone' => 'icon-search','js' => 'autoCompAdministradora()','span' => "popAdministradora' style='position:absolute"],'icone'),
    "</td>\r",

$this->FormDefault(['submit' => 'enviar'],'fim');

?> 
<script language="javascript">
    var dateFormat = 'dd/mm/yyyy';
    
    var tar = '<?php echo $this->url($this->matchedRouteName,$this->params); ?>';
    var formName = '<?php echo $this->formName ?>';
    function buscar(){
        var adm = document.getElementById('administradoraDesc').value;
        if(adm == '')
            document.getElementById('administradora').value = '';
        envia(tar,'buscar',formName);
        return false;
    }
    function autoCompAdministradora(){
        var filtros = 'administradoraDesc';
        var servico = "<?php echo $this->url('livraria-admin',array('controller'=>'administradoras','action'=>'autoComp')); ?>";
        var returns = Array('administradora','administradoraDesc');
        var functionCall = 'buscaAdministradora()';
        autoComp2(filtros,servico,'popAdministradora',returns,'2',functionCall);
    }
</script>